var mono="undefined"!==typeof mono?mono:void 0;
(function(q,m){if(!mono){if(q)return mono=m();exports.isFF=!0;exports.isModule=!0;exports.init=m}})("undefined"!==typeof window?window:void 0,function(q){var m,a={};(function(){if("undefined"===typeof window)a.isFF=!0,a.isModule=!0,a.addon=q,m=_require;else if("undefined"!==typeof GM_getValue)a.isGM=!0,window.hasOwnProperty("chrome")?a.isTM=!0:-1!==navigator.userAgent.indexOf("Maxthon/")&&(a.isVM=!0);else if(window.hasOwnProperty("chrome"))if(a.isChrome=!0,a.isChromeInject=!chrome.hasOwnProperty("tabs"),
chrome.app.hasOwnProperty("getDetails")){var e=chrome.app.getDetails();e&&"undefined"!==e.hasOwnProperty("app")&&(a.isChromeWebApp=!0)}else a.isChromeApp=!0;else window.hasOwnProperty("opera")?(a.isOpera=!0,a.isOperaInject=void 0===opera.extension.broadcastMessage):-1!==navigator.userAgent.indexOf("Firefox")?(a.isFF=!0,"undefined"!==typeof addon&&addon.hasOwnProperty("port")?a.addon=addon:"undefined"!==typeof self&&self.hasOwnProperty("port")?a.addon=self:a.noAddon=!0):window.hasOwnProperty("safari")?
(a.isSafari=!0,a.isSafariPopup="popup"===safari.self.identifier,a.isSafariBgPage=void 0===safari.self.addEventListener,a.isSafariInject=!a.isSafariPopup&&void 0===safari.application):-1!==navigator.userAgent.indexOf("Safari/")?a.isSafari=!0:console.error("Mono: can't define browser!")})();a.cloneObj=function(a){return JSON.parse(JSON.stringify(a))};var f={cbObj:{},cbStack:[],id:0,idPrefix:Math.floor(1E3*Math.random())+"_",addCb:function(e,c){void 0===a.onMessage.inited&&a.onMessage(function(){});
f.cbStack.length>a.messageStack&&f.clean();var b=e.callbackId=f.idPrefix+ ++f.id;f.cbObj[b]={fn:c,time:Date.now()};f.cbStack.push(b)},callCb:function(a){var c=f.cbObj[a.responseId];void 0!==c&&(delete f.cbObj[a.responseId],f.cbStack.splice(f.cbStack.indexOf(a.responseId),1),c.fn(a.data))},mkResponse:function(a,c,b){void 0!==c&&(b={data:b,responseId:c},a.call(this,b))},clearCbStack:function(){for(var a in f.cbObj)delete f.cbObj[a];f.cbStack.splice(0)},removeCb:function(a){void 0!==f.cbObj[a]&&(delete f.cbObj[a],
f.cbStack.splice(f.cbStack.indexOf(a),1))},clean:function(a){var c=Date.now();a=a||12E4;for(var b in f.cbObj)f.cbObj[b].time+a<c&&(delete f.cbObj[b],f.cbStack.splice(f.cbStack.indexOf(b),1))}};a.messageStack=50;a.msgClearStack=f.clearCbStack;a.msgRemoveCbById=f.removeCb;a.msgClean=f.clean;a.sendMessage=function(e,c,b){e={data:e,hook:b};c&&f.addCb(e,c.bind(this));a.sendMessage.send.call(this,e);return e.callbackId};a.sendMessageToActiveTab=function(e,c,b){e={data:e,hook:b};c&&f.addCb(e,c.bind(this));
a.sendMessage.sendToActiveTab.call(this,e);return e.callbackId};a.sendHook={};a.onMessage=function(e){var c=this;a.onMessage.inited=1;a.onMessage.on.call(c,function(b,d){if(void 0!==b.responseId)return f.callCb(b);var g=f.mkResponse.bind(c,d,b.callbackId);if(void 0!==b.hook){var k=a.sendHook[b.hook];if(void 0!==k)return k(b.data,g)}e.call(c,b.data,g)})};a.storage=void 0;(function(){if(a.isChrome&&chrome.hasOwnProperty("runtime")&&chrome.runtime.onMessage){var e={},c={cbList:[],mkResponse:function(b){return b.tab?
function(a){c.sendTo(a,b.tab.id)}:b.monoDirect?function(d){b(a.cloneObj(d),c.onMessage)}:function(a){c.send(a)}},sendTo:function(a,d){chrome.tabs.sendMessage(d,a)},onMessage:function(b,d,g){if(1===a.isChromeBgPage){if(1===b.fromBgPage)return}else if(1===b.toBgPage)return;if(void 0!==b.hook){var k=e[b.hook];if(void 0!==k)return k(b,d,g)}d=c.mkResponse(d);for(g=0;k=c.cbList[g];g++)k(b,d)},on:function(a){c.cbList.push(a);1===c.cbList.length&&chrome.runtime.onMessage.addListener(c.onMessage)},sendToActiveTab:function(a){chrome.tabs.query({active:!0,
currentWindow:!0},function(d){void 0===d[0]||0>d[0].id||c.sendTo(a,d[0].id)})},send:function(b){a.isChromeBgPage?b.fromBgPage=1:b.toBgPage=1;chrome.runtime.sendMessage(b)}};c.on.lowLevelHook=e;(function(){chrome.runtime.hasOwnProperty("getBackgroundPage")&&(a.isChromeBgPage=-1!==location.href.indexOf("_generated_background_page.html"),chrome.runtime.getBackgroundPage(function(b){b!==window?delete a.isChromeBgPage:a.isChromeBgPage=1;a.isChromeBgPage?void 0===a.chromeDirectOnMessage&&(a.chromeDirectOnMessage=
function(a,b){c.onMessage(a,b)}):(c.onMessage.monoDirect=!0,c.send=a.sendMessage.send=function(d){b.mono.chromeDirectOnMessage(a.cloneObj(d),c.onMessage)})}))})();a.onMessage.on=c.on;a.sendMessage.send=c.send;a.sendMessage.sendToActiveTab=c.sendToActiveTab}})();(function(){if(a.isFF){(function(){if(a.noAddon){var c=[];a.addon={port:{emit:function(a,d){var c=">"+JSON.stringify(d);window.postMessage(c,"*")},on:function(a,d){c.push(d);1<c.length||window.addEventListener("monoMessage",function(a){if("<"===
a.detail[0]){a=a.detail.substr(1);a=JSON.parse(a);for(var d=0,b;b=c[d];d++)b(a)}})}}}}})();var e={cbList:[],mkResponse:function(a){return function(b){e.sendTo(b,a)}},on:function(c){e.cbList.push(c);if(1===e.cbList.length)a.addon.port.on("mono",function(a){for(var d=e.mkResponse(a.from),c=0,k;k=e.cbList[c];c++)k(a,d)})},send:function(c){a.addon.port.emit("mono",c)},sendTo:function(c,b){c.to=b;a.addon.port.emit("mono",c)},sendToActiveTab:function(a){a.hook="activeTab";e.sendTo(a)}};a.onMessage.on=e.on;
a.sendMessage.send=e.send;a.sendMessage.sendToActiveTab=e.sendToActiveTab}})();(function(){if(!(!a.isChrome||chrome.hasOwnProperty("runtime")&&chrome.runtime.onMessage)){var e={},c={cbList:[],mkResponse:function(a,d){return a.tab&&-1<a.tab.id?function(d){c.sendTo(d,a.tab.id)}:function(a){d(a)}},sendTo:function(a,d){chrome.tabs.sendRequest(d,a,function(a){if(a&&void 0!==a.responseId)return f.callCb(a)})},onMessage:function(b,d,g){if(1===a.isChromeBgPage){if(1===b.fromBgPage)return}else if(1===b.toBgPage)return;
if(void 0!==b.hook){var k=e[b.hook];if(void 0!==k)return k(b,d,g)}d=c.mkResponse(d,g);for(g=0;k=c.cbList[g];g++)k(b,d)},on:function(a){c.cbList.push(a);1===c.cbList.length&&chrome.extension.onRequest.addListener(c.onMessage)},sendToActiveTab:function(a){chrome.tabs.query({active:!0,currentWindow:!0},function(d){void 0===d[0]||0>d[0].id||c.sendTo(a,d[0].id)})},send:function(b){a.isChromeBgPage?b.fromBgPage=1:b.toBgPage=1;chrome.extension.sendRequest(b,function(a){if(a&&void 0!==a.responseId)return f.callCb(a)})}};
c.on.lowLevelHook=e;(function(){try{if(void 0===chrome.runtime.getBackgroundPage)return}catch(b){return}a.isChromeBgPage=-1!==location.href.indexOf("_generated_background_page.html");chrome.runtime.getBackgroundPage(function(d){d!==window?delete a.isChromeBgPage:a.isChromeBgPage=1})})();a.onMessage.on=c.on;a.sendMessage.send=c.send;a.sendMessage.sendToActiveTab=c.sendToActiveTab}})();(function(){if(a.isSafari){var e,c;a.isSafariBgPage&&window.location&&window.location.href&&(e=window.location.href.substr(0,
window.location.href.indexOf("/",19)),c=e.length);var b={cbList:[],mkResponse:a.isSafariBgPage?function(a){return function(c){b.sendTo(c,a)}}:function(){return function(a){b.send(a)}},sendTo:function(a,b){b.page&&b.page.dispatchMessage&&b.page.dispatchMessage("message",a)},onMessage:function(a){var c=a.message;a=b.mkResponse(a.target);for(var e=0,n;n=b.cbList[e];e++)n(c,a)},on:function(d){b.cbList.push(d);if(1===b.cbList.length){(a.isSafariPopup||a.isSafariBgPage)&&void 0===a.safariDirectOnMessage&&
(a.safariDirectOnMessage=b.onMessage);if(a.isSafariBgPage)return safari.application.addEventListener("message",b.onMessage,!1);safari.self.addEventListener("message",b.onMessage,!1)}},sendToActiveTab:function(a){b.sendTo(a,safari.application.activeBrowserWindow.activeTab)},send:a.isSafariPopup?function(d){safari.extension.globalPage.contentWindow.mono.safariDirectOnMessage({message:a.cloneObj(d),target:{page:{dispatchMessage:function(d,b){a.safariDirectOnMessage({message:a.cloneObj(b)})}}}})}:a.isSafariBgPage?
function(d){for(var g=0,k;k=safari.extension.popovers[g];g++)k.contentWindow.mono.safariDirectOnMessage({message:a.cloneObj(d),target:{page:{dispatchMessage:function(d,b){a.safariDirectOnMessage({message:a.cloneObj(b)})}}}});for(g=0;k=safari.application.browserWindows[g];g++)for(var n=0,h;h=k.tabs[n];n++)h.url&&h.url.substr(0,c)===e&&b.sendTo(d,h)}:function(a){b.sendTo(a,{page:safari.self.tab})}};a.onMessage.on=b.on;a.sendMessage.send=b.send;a.sendMessage.sendToActiveTab=b.sendToActiveTab}})();(function(){if(a.isOpera){var e=
window.location&&window.location.href&&"widget://"===window.location.href.substr(0,9),c={cbList:[],mkResponse:function(a){return function(d){c.sendTo(d,a)}},sendTo:function(a,d){try{d.postMessage(a)}catch(c){}},on:function(a){c.cbList.push(a);1===c.cbList.length&&(opera.extension.onmessage=function(a){var b=a.data;if(1!==b.toLocalScope||!1!==e){a=c.mkResponse(a.source);for(var k=0,n;n=c.cbList[k];k++)n(b,a)}})},sendToActiveTab:function(a){var d=opera.extension.tabs.getSelected();c.sendTo(a,d)},send:a.isOperaInject?
function(a){c.sendTo(a,opera.extension)}:function(a){a.toLocalScope=1;opera.extension.broadcastMessage(a)}};a.onMessage.on=c.on;a.sendMessage.send=c.send;a.sendMessage.sendToActiveTab=c.sendToActiveTab}})();(function(){if(a.isGM){var e={cbList:[],onMessage:function(c){c=a.cloneObj(c);for(var b=e.onMessage,d=0,g;g=e.cbList[d];d++)this.isBg!==g.isBg&&g(c,b.bind({isBg:g.isBg}))},on:function(a){a.isBg=this.isBg;e.cbList.push(a)}};e.send=e.onMessage;a.onMessage.on=e.on;a.sendMessage.send=e.send;a.sendMessage.sendToActiveTab=
e.onMessage.bind({isBg:!0})}})();a.isChrome&&chrome.hasOwnProperty("storage")&&(a.storage=chrome.storage.local,a.storage.local=a.storage,a.storage.sync=chrome.storage.sync);(function(){a.isFF&&(a.storage=a.isModule?function(){var a=m("sdk/simple-storage");return{get:function(c,b){var d,g={};if(void 0===c||null===c){for(d in a.storage)a.storage.hasOwnProperty(d)&&(g[d]=a.storage[d]);return b(g)}"string"===typeof c&&(c=[c]);if(!0===Array.isArray(c))for(var k=0,n=c.length;k<n;k++)d=c[k],a.storage.hasOwnProperty(d)&&
(g[d]=a.storage[d]);else for(d in c)a.storage.hasOwnProperty(d)&&(g[d]=a.storage[d]);b(g)},set:function(c,b){for(var d in c)a.storage[d]=c[d];b&&b()},remove:function(c,b){if(Array.isArray(c))for(var d=0,g=c.length;d<g;d++)delete a.storage[c[d]];else delete a.storage[c];b&&b()},clear:function(c){for(var b in a.storage)delete a.storage[b];c&&c()}}}():{get:function(e,c){a.sendMessage({action:"get",data:e},c,"monoStorage")},set:function(e,c){a.sendMessage({action:"set",data:e},c,"monoStorage")},remove:function(e,
c){a.sendMessage({action:"remove",data:e},c,"monoStorage")},clear:function(e){a.sendMessage({action:"clear"},e,"monoStorage")}},a.storage.local=a.storage.sync=a.storage)})();(function(){a.isGM&&(a.storage={get:function(a,c){var b,d,g={};if(void 0===a||null===a){d=GM_listValues();for(b in d)g[b]=GM_getValue(b);return c(g)}"string"===typeof a&&(a=[a]);if(!0===Array.isArray(a))for(var k=0,n=a.length;k<n;k++)b=a[k],d=GM_getValue(b),void 0!==d&&(g[b]="object"!==typeof d?d:JSON.parse(JSON.stringify(d)));
else for(b in a)d=GM_getValue(b),void 0!==d&&(g[b]="object"!==typeof d?d:JSON.parse(JSON.stringify(d)));c(g)},set:function(a,c){for(var b in a)"object"!==typeof a[b]?GM_setValue(b,a[b]):GM_setValue(b,JSON.parse(JSON.stringify(a[b])));c&&c()},remove:function(a,c){if(Array.isArray(a))for(var b=0,d=a.length;b<d;b++)GM_deleteValue(a[b]);else GM_deleteValue(a);c&&c()},clear:function(a){var c=GM_listValues(),b;for(b in c)GM_deleteValue(b);a&&a()}},a.storage.local=a.storage.sync=a.storage)})();(function(){if(!a.storage){var e=
function(a){var c={getObj:function(b){var e=0,h=c.chunkPrefix+b,l=a[h+e];for(b="";void 0!==l;)b+=l,e++,l=a[h+e];e=void 0;try{e=JSON.parse(b)}catch(f){}return e},setObj:function(b,e){e=JSON.stringify(e);var h=c.chunkPrefix+b,l=1024-h.length-3;void 0===c.regexp&&(c.regexp=new RegExp(".{1,"+l+"}","g"));if(512<=Math.floor(e.length/l))console.log("monoLog:","localStorage","Can't save item",b,", very big!");else{for(var l=e.match(c.regexp),f=l.length,p=0,m;p<f;p++)m=l[p],a[h+p]=m;a[b]=c.chunkItem;c.rmObj(b,
f)}},rmObj:function(b,e){var h=c.chunkPrefix+b;void 0===e&&(e=0);for(var f=a[h+e];void 0!==f;)delete a[h+e],e++,f=a[h+e]},readValue:function(a,b){if(b===c.chunkItem)b=c.getObj(a);else if(void 0!==b){var d=b.substr(1),e=b[0];b="i"===e?parseFloat(d):"b"===e?"true"===d:d}return b},get:function(b,e){var h,f={};if(void 0===b||null===b){for(h in a)a.hasOwnProperty(h)&&"length"!==h&&h.substr(0,c.chunkLen)!==c.chunkPrefix&&(f[h]=c.readValue(h,a[h]));return e(f)}"string"===typeof b&&(b=[b]);if(!0===Array.isArray(b))for(var r=
0,m=b.length;r<m;r++)h=b[r],a.hasOwnProperty(h)&&(f[h]=c.readValue(h,a[h]));else for(h in b)a.hasOwnProperty(h)&&(f[h]=c.readValue(h,a[h]));e(f)},set:function(b,e){for(var f in b){var l=b[f];if(void 0===l)c.remove(f);else if("object"===typeof l)c.setObj(f,l);else{var m=typeof l,l="boolean"===m?"b"+l:"number"===m?"i"+l:"s"+l;a[f]=l}}e&&e()},remove:function(b,e){if(Array.isArray(b))for(var f=0,l=b.length;f<l;f++){var m=b[f];a[m]===c.chunkItem&&c.rmObj(m);delete a[m]}else a[b]===c.chunkItem&&c.rmObj(b),
delete a[b];e&&e()},clear:function(b){a.clear();b&&b()},chunkPrefix:"mCh_"};c.chunkLen=c.chunkPrefix.length;c.chunkItem="monoChunk";return c},c={get:function(b,c){a.sendMessage({action:"get",data:b},c,"monoStorage")},set:function(b,c){a.sendMessage({action:"set",data:b},c,"monoStorage")},remove:function(b,c){a.sendMessage({action:"remove",data:b},c,"monoStorage")},clear:function(b){a.sendMessage({action:"clear"},b,"monoStorage")}},b=function(b,c){if("get"===b.action)return a.storage.get(b.data,c);
if("set"===b.action)return a.storage.set(b.data,c);if("remove"===b.action)return a.storage.remove(b.data,c);if("clear"===b.action)return a.storage.clear(c)};if(a.isFF||a.isChromeInject||a.isOperaInject||a.isSafariInject)a.storage=c,a.storage.local=a.storage.sync=a.storage;else if(window.localStorage){if(a.storage=e(window.localStorage),a.storage.local=a.storage.sync=a.storage,a.isChrome||a.isSafari||a.isOpera)a.sendHook.monoStorage=b}else console.error("Can't detect storage!")}})();return a});
